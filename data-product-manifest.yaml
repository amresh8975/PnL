version: 0.0.18
jobId: "1170"
jobName: Sales Volume
jobType: Source Aligned Data Product
domain: finance
alias: Load_Iceberg_PnL_Volume
discoveryPort:
  name: Sales Volume
inputPorts:
  - alias: Volume__1
    isDynamic: true
    path: /data/use-case/PnL/Output/Sales/Volume
    optional:
      persistDataFrame: false
      advanceOptions:
        delimiter: ","
      enableDataReconciliation: false
      enforceSchema: false
      connection: Finance On-Prem Connectivity
      dataSetUrn: urn:dv:dataset:dfb72bb0-df15-4117-a1c8-4bb738eb2838
    type: inputDelimited
productState:
  isDynamic: true
  alias: Load_Iceberg_PnL_Volume
  retentionVersions: ""
  logicalSchema:
    properties:
      "Model_Code ":
        type: STRING
        description: ""
      "Upload_Description ":
        type: STRING
        description: ""
      "Continent ":
        type: STRING
        description: ""
      "Country ":
        type: STRING
        description: ""
      "Region ":
        type: STRING
        description: ""
      "State ":
        type: STRING
        description: ""
      "City ":
        type: STRING
        description: ""
      "Group_Non_Group ":
        type: STRING
        description: ""
      "Trade_Type ":
        type: STRING
        description: ""
      "Port ":
        type: STRING
        description: ""
      "Currency ":
        type: STRING
        description: ""
      "Month ":
        type: STRING
        description: ""
      Volume:
        type: STRING
        description: ""
      etl_inserted_date:
        type: STRING
        description: ""
      etl_modified_date:
        type: STRING
        description: ""
      etl_created_by:
        type: STRING
        description: ""
      etl_updated_by:
        type: STRING
        description: ""
  stateStoreType: loadDataIceberg
  isProfilingEnabled: false
  updateStrategy: Overwrite
  tableName: msil_dataverse_finance_catalog.Sales_Volume
  warehousePath: /data/iceberg_warehouse
  catalogName: postgres
  optional:
    persistDataFrame: false
    enableDataReconciliation: false
    enforceSchema: false
    enforceSchemaMethod: Warning
    catalogType: postgres
  refreshInterval: None
transformation:
  - isDynamic: true
    alias: Spark_SQL_1
    description: Sql Transformation
    sequence: 2
    inputDataFrameList:
      - inputDataFrame: Volume__1
        tempViewName: Volume
    query: SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    Month,    Volume,   current_timestamp()
      AS etl_inserted_date,   current_timestamp() AS
      etl_modified_date,   'platform_admin' AS
      etl_created_by,   'platform_admin' AS
      etl_updated_by    FROM  (      SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Apr"
      as month,    apr as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "May"
      as month,    may as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Jun"
      as month,    jun as volume    from    volume    union
      all    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Jul"
      as month,    jul as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Aug"
      as month,    aug as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Sep"
      as month,    sep as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Oct"
      as month,    oct as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Nov"
      as month,    nov as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Dec"
      as month,    dec as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Jan"
      as month,    jan as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Feb"
      as month,    feb as volume    FROM    VOLUME    UNION
      ALL    SELECT    model_code,    upload_description,    continent,    country,    region,    state,    city,    group_non_group,    trade_type,    port,    currency,    "Mar"
      as month,    mar as volume    FROM    VOLUME  )
    optional:
      persistDataFrame: false
    type: operationThroughSqlQuery
controlPort:
  dataQualityRules: {}
outputPort:
  subscriptionChannels:
    - channelType: Postgres
      queryType: SQL
    - channelType: Dataproduct
      queryType: SQL
